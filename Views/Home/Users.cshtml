@using Microsoft.Graph
@{
    ViewData["Title"] = "Users list";
}

<h2>Users</h2>

<table class="table table-striped table-condensed" style="font-family: monospace">
    <tr>
        <th>Id</th>
        <th>DisplayName</th>
        <th>Mail</th>
        <th>UserPrincipalName</th>
    </tr>
    @{ IList<ApplicationUser> users = ViewData["Users"] as IList<ApplicationUser>;

        foreach (var user in users)
        {
            @if (!string.IsNullOrEmpty(user.UserId)) {
            <tr>
                <td>@user.UserId</td>
                <td>@user.DisplayName</td>
                <td>@user.Mail</td>
                <td>@user.UserPrincipalName</td>
            </tr> 
            }
        }
    }
</table>
